from train_network.calculate_tool.data_preprocess3 import generate_dataset3, generate_dataset_allexcel3_beta
import numpy as np
import pandas as pd
from train_network.calculate_tool.data_preprocess1 import timefn


def get_file_path(sheet_name):
    global file_path
    file_path_list = [
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\Historical flood data from 1984 to 1999.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\Historical flood data from 2000 to 2023.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(0.5 times) Simulated flood data from 1984 to 1999.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(0.5 times) Simulated flood data from 2000 to 2023.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(0.8 times) Simulated flood data from 1984 to 1999.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(0.8 times) Simulated flood data from 2000 to 2023.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(1.2 times) Simulated flood data from 1984 to 1999.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(1.2 times) Simulated flood data from 2000 to 2023.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(1.5 times) Simulated flood data from 1984 to 1999.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(1.5 times) Simulated flood data from 2000 to 2023.xlsx']
    # Change to your file path

    file_class1 = int(sheet_name[:4])
    if 1984 <= file_class1 <= 1999:
        file_path = file_path_list[0]
    if 2000 <= file_class1 <= 2020:
        file_path = file_path_list[1]

    file_class2 = sheet_name[8:13]
    if sheet_name[8:12] == ' (2)':
        file_class2 = sheet_name[12:17]
    if file_class2 == '(0.5)':
        year = int(sheet_name[:4])
        if 1984 <= year <= 1999:
            file_path = file_path_list[2]
        if 2000 <= year <= 2020:
            file_path = file_path_list[3]
    if file_class2 == '(0.8)':
        year = int(sheet_name[:4])
        if 1984 <= year <= 1999:
            file_path = file_path_list[4]
        if 2000 <= year <= 2020:
            file_path = file_path_list[5]
    if file_class2 == '(1.2)':
        year = int(sheet_name[:4])
        if 1984 <= year <= 1999:
            file_path = file_path_list[6]
        if 2000 <= year <= 2020:
            file_path = file_path_list[7]
    if file_class2 == '(1.5)':
        year = int(sheet_name[:4])
        if 1984 <= year <= 1999:
            file_path = file_path_list[8]
        if 2000 <= year <= 2020:
            file_path = file_path_list[9]

    return file_path


@timefn
def generate_dataset_from_sheet(sheet_names, is_policy=True):
    global features, labels
    for i, sheet in enumerate(sheet_names):
        file_path1 = get_file_path(sheet)
        if is_policy:
            features_sheet, labels_sheet, _ = generate_dataset3(file_path1, sheet)
        else:
            features_sheet, _, labels_sheet = generate_dataset3(file_path1, sheet)
        if i == 0:
            features, labels = features_sheet, labels_sheet
        else:
            features = np.concatenate((features, features_sheet), axis=0)
            labels = np.concatenate((labels, labels_sheet), axis=0)
    return features, labels


# Used for mixed sheet names
@timefn
def generate_dataset_from_sheet_bata(sheet_names_val, is_policy=True):
    global features, labels
    file_path_list = [
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\Historical flood data from 1984 to 1999.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\Historical flood data from 2000 to 2023.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(0.5 times) Simulated flood data from 1984 to 1999.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(0.5 times) Simulated flood data from 2000 to 2023.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(0.8 times) Simulated flood data from 1984 to 1999.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(0.8 times) Simulated flood data from 2000 to 2023.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(1.2 times) Simulated flood data from 1984 to 1999.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(1.2 times) Simulated flood data from 2000 to 2023.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(1.5 times) Simulated flood data from 1984 to 1999.xlsx',
        r'C:\Users\Longwen-Liu\Desktop\FloodGo-Version1.0-main\data\(1.5 times) Simulated flood data from 2000 to 2023.xlsx']
    # Change to your file path
    sheet_names_0, sheet_names_1, sheet_names_2, sheet_names_3, sheet_names_4 = [], [], [], [], []
    sheet_names_5, sheet_names_6, sheet_names_7, sheet_names_8, sheet_names_9 = [], [], [], [], []
    for sheet in sheet_names_val:
        file_path1 = get_file_path(sheet)
        if file_path1 == file_path_list[0]:
            sheet_names_0.append(sheet)
        if file_path1 == file_path_list[1]:
            sheet_names_1.append(sheet)
        if file_path1 == file_path_list[2]:
            sheet_names_2.append(sheet)
        if file_path1 == file_path_list[3]:
            sheet_names_3.append(sheet)
        if file_path1 == file_path_list[4]:
            sheet_names_4.append(sheet)
        if file_path1 == file_path_list[5]:
            sheet_names_5.append(sheet)
        if file_path1 == file_path_list[6]:
            sheet_names_6.append(sheet)
        if file_path1 == file_path_list[7]:
            sheet_names_7.append(sheet)
        if file_path1 == file_path_list[8]:
            sheet_names_8.append(sheet)
        if file_path1 == file_path_list[9]:
            sheet_names_9.append(sheet)
    sheet_names = [sheet_names_0, sheet_names_1, sheet_names_2, sheet_names_3, sheet_names_4,
                   sheet_names_5, sheet_names_6, sheet_names_7, sheet_names_8, sheet_names_9]

    for i in range(len(sheet_names)):
        if is_policy:
            features_sheet, labels_sheet, _ = generate_dataset_allexcel3_beta(file_path_list[i], sheet_names[i])
        else:
            features_sheet, _, labels_sheet = generate_dataset_allexcel3_beta(file_path_list[i], sheet_names[i])
        if i == 0:
            features, labels = features_sheet, labels_sheet
        else:
            features = np.concatenate((features, features_sheet), axis=0)
            labels = np.concatenate((labels, labels_sheet), axis=0)

    return features, labels


def generate_dataset_simulate_groups(file_path, num_interval):
    global sheet_group
    excel_file = pd.ExcelFile(file_path)
    sheet_names = excel_file.sheet_names
    num_sheets = len(sheet_names)
    sheet_groups = []
    for i in range(num_interval):
        sheet_group = []
        group = np.arange(i + 1, num_sheets, num_interval)
        for j in group:
            sheet_group.append(sheet_names[j])
        sheet_groups.append(sheet_group)
    return sheet_groups


def get_sheet_name():
    sheet_names = ['19840504', '19840531', '19840612', '19850527', '19870511', '19870520', '19880613', '19890419',
                   '19890513', '19890630', '19900613', '19910322', '19910330', '19920325', '19920325 (2)', '19920426',
                   '19920502', '19920619', '19920624', '19920706', '19930625', '19930701', '19940615', '19940615 (2)',
                   '19950617', '19950627', '19950814', '19960601', '19970613', '19970712', '19980216', '19980309',
                   '19980806', '19990417', '19990526', '19990718', '20000611', '20000825', '20010509', '20010604',
                   '20010613', '20020616', '20020616 (2)', '20020625', '20020625 (2)', '20020701', '20020720',
                   '20021030', '20030516', '20040622', '20040707', '20050505', '20050509', '20050515', '20050524',
                   '20050524 (2)', '20050527', '20050618', '20060518', '20060522', '20060531', '20060605', '20060607',
                   '20070610', '20070614', '20080614', '20080614 (2)', '20080731', '20090702', '20100406', '20100413',
                   '20100514', '20100519', '20100523', '20100614', '20100618', '20100623', '20100707', '20120307',
                   '20120501', '20120513', '20120611', '20120624', '20120804', '20140515', '20140517', '20140522',
                   '20140602', '20140619', '20140714', '20140724', '20150519', '20150530', '20150530 (2)',
                   '20150611 (2)', '20150702', '20150702 (2)', '20150906', '20160520', '20160618', '20160618 (2)',
                   '20160710', '20160718', '20161126', '20170626', '20170802', '20180711', '20190516', '20190519',
                   '20190609', '20190613', '20190707', '20190709', '20190714', '20200606', '20210511', '20210526',
                   '20210529', '20210603', '20220216', '20220329', '20220508', '20220530', '20220604', '20220611',
                   '20220616', '20230519', '20230603', '20230606', '19840408(0.5)', '19840408 (2)(0.5)',
                   '19840531(0.5)', '19840612(0.5)', '19840615(0.5)', '19860420(0.5)', '19870511(0.5)', '19870520(0.5)',
                   '19880613(0.5)', '19890419(0.5)', '19890513(0.5)', '19890516(0.5)', '19890523(0.5)', '19890630(0.5)',
                   '19910322(0.5)', '19910330(0.5)', '19920325(0.5)', '19920426(0.5)', '19920502(0.5)', '19920619(0.5)',
                   '19920624(0.5)', '19920706(0.5)', '19930625(0.5)', '19930701(0.5)', '19940502(0.5)', '19940615(0.5)',
                   '19940615 (2)(0.5)', '19950627(0.5)', '19950814(0.5)', '19960601(0.5)', '19970613(0.5)',
                   '19970712(0.5)', '19980216(0.5)', '19980309(0.5)', '19980620(0.5)', '19980806(0.5)', '19990417(0.5)',
                   '19990526(0.5)', '19990718(0.5)', '20000611(0.5)', '20010506(0.5)', '20010509(0.5)', '20010604(0.5)',
                   '20010613(0.5)', '20020616(0.5)', '20020625(0.5)', '20020625 (2)(0.5)', '20020701(0.5)',
                   '20020720(0.5)', '20021030(0.5)', '20030516(0.5)', '20040707(0.5)', '20050505(0.5)', '20050509(0.5)',
                   '20050515(0.5)', '20050524(0.5)', '20050524 (2)(0.5)', '20050527(0.5)', '20050618(0.5)',
                   '20050621(0.5)', '20060518(0.5)', '20060522(0.5)', '20060531(0.5)', '20060605(0.5)', '20060607(0.5)',
                   '20070610(0.5)', '20070614(0.5)', '20080614(0.5)', '20080614 (2)(0.5)', '20080731(0.5)',
                   '20100406(0.5)', '20100413(0.5)', '20100514(0.5)', '20100519(0.5)', '20100523(0.5)', '20100614(0.5)',
                   '20100618(0.5)', '20100623(0.5)', '20100707(0.5)', '20120307(0.5)', '20120425(0.5)', '20120501(0.5)',
                   '20120513(0.5)', '20120611(0.5)', '20120624(0.5)', '20120804(0.5)', '20140515(0.5)', '20140517(0.5)',
                   '20140522(0.5)', '20140602(0.5)', '20140619(0.5)', '20140714(0.5)', '20150519(0.5)', '20150530(0.5)',
                   '20150530 (2)(0.5)', '20150611(0.5)', '20150611 (2)(0.5)', '20150702(0.5)', '20150702 (2)(0.5)',
                   '20150906(0.5)', '20160409(0.5)', '20160508(0.5)', '20160520(0.5)', '20160618(0.5)',
                   '20160618 (2)(0.5)', '20160710(0.5)', '20160718(0.5)', '20161126(0.5)', '20170626(0.5)',
                   '20170802(0.5)', '20180711(0.5)', '20190519(0.5)', '20190613(0.5)', '20190622(0.5)', '20190709(0.5)',
                   '20190714(0.5)', '20200609(0.5)', '20210511(0.5)', '20210526(0.5)', '20210529(0.5)', '20210603(0.5)',
                   '20220216(0.5)', '20220329(0.5)', '20220425(0.5)', '20220508(0.5)', '20220530(0.5)', '20220604(0.5)',
                   '20220611(0.5)', '20230417(0.5)', '20230603(0.5)', '20230606(0.5)', '19840408(0.8)',
                   '19840408 (2)(0.8)', '19840504(0.8)', '19840531(0.8)', '19840615(0.8)', '19850527(0.8)',
                   '19860420(0.8)', '19870511(0.8)', '19870520(0.8)', '19880613(0.8)', '19890419(0.8)', '19890513(0.8)',
                   '19890516(0.8)', '19890630(0.8)', '19900613(0.8)', '19910322(0.8)', '19910330(0.8)', '19920325(0.8)',
                   '19920325 (2)(0.8)', '19920426(0.8)', '19920502(0.8)', '19920619(0.8)', '19920624(0.8)',
                   '19920706(0.8)', '19930625(0.8)', '19940502(0.8)', '19940615(0.8)', '19940615 (2)(0.8)',
                   '19950617(0.8)', '19950627(0.8)', '19950814(0.8)', '19970712(0.8)', '19980216(0.8)', '19980620(0.8)',
                   '19980806(0.8)', '19990417(0.8)', '19990718(0.8)', '20000611(0.8)', '20010506(0.8)', '20010509(0.8)',
                   '20010604(0.8)', '20010613(0.8)', '20020616(0.8)', '20020616 (2)(0.8)', '20020625(0.8)',
                   '20020625 (2)(0.8)', '20020701(0.8)', '20020720(0.8)', '20021030(0.8)', '20040622(0.8)',
                   '20040707(0.8)', '20050505(0.8)', '20050509(0.8)', '20050515(0.8)', '20050524(0.8)',
                   '20050524 (2)(0.8)', '20050527(0.8)', '20050618(0.8)', '20050621(0.8)', '20060518(0.8)',
                   '20060522(0.8)', '20060531(0.8)', '20060605(0.8)', '20070610(0.8)', '20070614(0.8)', '20080614(0.8)',
                   '20080614 (2)(0.8)', '20080731(0.8)', '20090702(0.8)', '20100406(0.8)', '20100413(0.8)',
                   '20100514(0.8)', '20100519(0.8)', '20100523(0.8)', '20100614(0.8)', '20100623(0.8)', '20100707(0.8)',
                   '20120307(0.8)', '20120425(0.8)', '20120501(0.8)', '20120513(0.8)', '20120611(0.8)', '20120624(0.8)',
                   '20120804(0.8)', '20140515(0.8)', '20140517(0.8)', '20140522(0.8)', '20140602(0.8)', '20140714(0.8)',
                   '20140724(0.8)', '20150519(0.8)', '20150530(0.8)', '20150530 (2)(0.8)', '20150611(0.8)',
                   '20150611 (2)(0.8)', '20150702(0.8)', '20150702 (2)(0.8)', '20150906(0.8)', '20160409(0.8)',
                   '20160508(0.8)', '20160520(0.8)', '20160618(0.8)', '20160710(0.8)', '20160718(0.8)', '20161126(0.8)',
                   '20170626(0.8)', '20170802(0.8)', '20180711(0.8)', '20190516(0.8)', '20190519(0.8)', '20190609(0.8)',
                   '20190613(0.8)', '20190707(0.8)', '20190709(0.8)', '20190714(0.8)', '20200606(0.8)', '20200609(0.8)',
                   '20210511(0.8)', '20210526(0.8)', '20210529(0.8)', '20220216(0.8)', '20220329(0.8)', '20220425(0.8)',
                   '20220508(0.8)', '20220530(0.8)', '20220604(0.8)', '20220611(0.8)', '20230417(0.8)', '20230519(0.8)',
                   '20230603(0.8)', '20230606(0.8)', '19840408(1.2)', '19840504(1.2)', '19840531(1.2)', '19840615(1.2)',
                   '19850527(1.2)', '19860420(1.2)', '19870511(1.2)', '19870520(1.2)', '19880613(1.2)', '19890419(1.2)',
                   '19890513(1.2)', '19890516(1.2)', '19890523(1.2)', '19890630(1.2)', '19900613(1.2)', '19910322(1.2)',
                   '19910330(1.2)', '19920426(1.2)', '19920502(1.2)', '19920619(1.2)', '19920624(1.2)', '19920706(1.2)',
                   '19930625(1.2)', '19930701(1.2)', '19940502(1.2)', '19940615(1.2)', '19940615 (2)(1.2)',
                   '19950617(1.2)', '19950627(1.2)', '19950814(1.2)', '19960601(1.2)', '19970712(1.2)', '19980216(1.2)',
                   '19980309(1.2)', '19980514(1.2)', '19980620(1.2)', '19980806(1.2)', '19990417(1.2)', '19990718(1.2)',
                   '20000611(1.2)', '20000825(1.2)', '20010506(1.2)', '20010509(1.2)', '20010604(1.2)', '20010613(1.2)',
                   '20020616(1.2)', '20020616 (2)(1.2)', '20020625(1.2)', '20020701(1.2)', '20020720(1.2)',
                   '20021030(1.2)', '20040622(1.2)', '20040707(1.2)', '20050505(1.2)', '20050509(1.2)', '20050515(1.2)',
                   '20050524(1.2)', '20050524 (2)(1.2)', '20050527(1.2)', '20050618(1.2)', '20050621(1.2)',
                   '20060518(1.2)', '20060522(1.2)', '20060531(1.2)', '20060605(1.2)', '20060607(1.2)', '20070614(1.2)',
                   '20080614(1.2)', '20080614 (2)(1.2)', '20090702(1.2)', '20100406(1.2)', '20100413(1.2)',
                   '20100514(1.2)', '20100519(1.2)', '20100523(1.2)', '20100614(1.2)', '20100618(1.2)', '20100623(1.2)',
                   '20100707(1.2)', '20120307(1.2)', '20120513(1.2)', '20120611(1.2)', '20120624(1.2)', '20120804(1.2)',
                   '20140515(1.2)', '20140517(1.2)', '20140522(1.2)', '20140602(1.2)', '20140619(1.2)', '20140714(1.2)',
                   '20140724(1.2)', '20150519(1.2)', '20150530(1.2)', '20150530 (2)(1.2)', '20150611(1.2)',
                   '20150702(1.2)', '20150702 (2)(1.2)', '20160409(1.2)', '20160508(1.2)', '20160520(1.2)',
                   '20160618(1.2)', '20160618 (2)(1.2)', '20160710(1.2)', '20160718(1.2)', '20161126(1.2)',
                   '20180711(1.2)', '20190519(1.2)', '20190613(1.2)', '20190622(1.2)', '20190709(1.2)', '20190714(1.2)',
                   '20200606(1.2)', '20200609(1.2)', '20210511(1.2)', '20210526(1.2)', '20210603(1.2)', '20220216(1.2)',
                   '20220329(1.2)', '20220425(1.2)', '20220508(1.2)', '20220530(1.2)', '20220611(1.2)', '20220616(1.2)',
                   '20230417(1.2)', '20230519(1.2)', '20230603(1.2)', '20230606(1.2)', '19840408 (2)(1.5)',
                   '19840504(1.5)', '19840531(1.5)', '19840615(1.5)', '19850527(1.5)', '19870511(1.5)', '19870520(1.5)',
                   '19890419(1.5)', '19890513(1.5)', '19890516(1.5)', '19890523(1.5)', '19900613(1.5)', '19910322(1.5)',
                   '19910330(1.5)', '19920325(1.5)', '19920426(1.5)', '19920502(1.5)', '19920619(1.5)', '19920624(1.5)',
                   '19920706(1.5)', '19930701(1.5)', '19940615(1.5)', '19940615 (2)(1.5)', '19950617(1.5)',
                   '19950627(1.5)', '19950814(1.5)', '19960601(1.5)', '19970613(1.5)', '19970712(1.5)', '19980216(1.5)',
                   '19980309(1.5)', '19980514(1.5)', '19980806(1.5)', '19990417(1.5)', '19990718(1.5)', '20000611(1.5)',
                   '20000825(1.5)', '20010506(1.5)', '20010509(1.5)', '20010613(1.5)', '20020616(1.5)',
                   '20020616 (2)(1.5)', '20020625(1.5)', '20020625 (2)(1.5)', '20020701(1.5)', '20020720(1.5)',
                   '20021030(1.5)', '20030516(1.5)', '20040622(1.5)', '20040707(1.5)', '20050505(1.5)', '20050509(1.5)',
                   '20050524 (2)(1.5)', '20050527(1.5)', '20050618(1.5)', '20060518(1.5)', '20060522(1.5)',
                   '20060531(1.5)', '20060605(1.5)', '20060607(1.5)', '20080614(1.5)', '20080731(1.5)', '20090702(1.5)',
                   '20100406(1.5)', '20100413(1.5)', '20100514(1.5)', '20100519(1.5)', '20100523(1.5)', '20100614(1.5)',
                   '20100618(1.5)', '20100707(1.5)', '20120425(1.5)', '20120501(1.5)', '20120513(1.5)', '20120611(1.5)',
                   '20120624(1.5)', '20120804(1.5)', '20140517(1.5)', '20140522(1.5)', '20140602(1.5)', '20140619(1.5)',
                   '20140714(1.5)', '20140724(1.5)', '20150519(1.5)', '20150530(1.5)', '20150611(1.5)',
                   '20150611 (2)(1.5)', '20150702(1.5)', '20150702 (2)(1.5)', '20160409(1.5)', '20160508(1.5)',
                   '20160520(1.5)', '20160618(1.5)', '20160618 (2)(1.5)', '20160710(1.5)', '20160718(1.5)',
                   '20170802(1.5)', '20180711(1.5)', '20190516(1.5)', '20190519(1.5)', '20190609(1.5)', '20190613(1.5)',
                   '20190622(1.5)', '20190707(1.5)', '20190709(1.5)', '20200606(1.5)', '20210511(1.5)', '20210526(1.5)',
                   '20210529(1.5)', '20210603(1.5)', '20220216(1.5)', '20220329(1.5)', '20220425(1.5)', '20220508(1.5)',
                   '20220530(1.5)', '20220604(1.5)', '20220616(1.5)', '20230417(1.5)', '20230519(1.5)', '20230606(1.5)']
    return sheet_names
